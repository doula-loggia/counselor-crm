# 프로젝트 정보

## 개요
단일 치료사를 위한 클라이언트 관리 시스템 - Python Flask 기반 웹 애플리케이션
AI 기반 축어록 분석 기능 포함

## 최근 변경사항
- 2025-10-16: 프로젝트 초기 구축 및 AI 분석 기능 추가
  - Python Flask 웹 앱 구조 설정
  - CSV 기반 데이터 저장소 구현
  - 한글 UI 템플릿 작성 (로그인, 홈, 내담자, 회기, 회기 상세)
  - 환경변수 기반 단일 사용자 인증 시스템
  - **OpenAI GPT-5 기반 축어록 AI 분석 기능 구현**
    - 축어록 파일 업로드 또는 직접 입력
    - 전체 이야기 요약
    - 스트레스 요인 분석
    - 상담자 개입 평가 및 개선 대안
    - 이후 상담 계획 수립 가이드
    - 내담자 주요 감정 분석
    - 인지왜곡 및 당위적 사고 분석
    - 저항 패턴 분석
  - **음성 파일 업로드 및 재생 기능**
    - MP3, WAV, M4A, OGG 등 다양한 형식 지원
    - 회기 상세 페이지에서 음성 파일 업로드
    - 내장 오디오 플레이어로 재생 가능
    - data/audio 폴더에 안전하게 저장
  - **결제수단 필드 추가**
    - 회기 추가 시 결제수단 선택 (현금/카드/바우처/무료)
    - 회기 목록 및 상세 페이지에 표시
  - **내담자 목록 UI 개선**
    - 내담자 이름 클릭 시 상세 페이지로 이동
    - "보기" 버튼 제거하여 더 깔끔한 UI
  - **내담자/회기 정보 수정 기능 추가**
    - 내담자 목록에서 "수정" 버튼 클릭
    - 회기 목록/상세에서 "수정" 버튼 클릭
    - 모든 정보 수정 가능 (내담자 상태, 회기 정보 등)
  - **CSV 다운로드 버튼 개선**
    - 내담자 목록/회기 목록 상단에 다운로드 버튼 배치
  - **회기 상세 페이지 네비게이션 버그 수정**
    - session 변수 충돌 문제 해결 (session_data로 변경)
    - 상단 메뉴가 모든 페이지에서 정상 표시

## 프로젝트 아키텍처

### 기술 스택
- **언어**: Python 3.11
- **프레임워크**: Flask 3.0.0
- **데이터**: Pandas (CSV 읽기/쓰기)
- **인증**: Flask Session + 환경변수
- **AI**: OpenAI GPT-5 (축어록 분석)

### 디렉토리 구조
```
/
├── main.py                 # Flask 앱 메인 파일
├── requirements.txt        # Python 의존성
├── templates/             # HTML 템플릿
│   ├── base.html          # 기본 레이아웃
│   ├── login.html         # 로그인 페이지
│   ├── home.html          # 홈/대시보드
│   ├── clients_list.html  # 내담자 목록
│   ├── client_form.html   # 내담자 추가 폼
│   ├── client_detail.html # 내담자 상세
│   ├── client_edit.html   # 내담자 수정
│   ├── sessions_list.html # 회기 목록
│   ├── session_form.html  # 회기 추가 폼
│   └── session_detail.html # 회기 상세 및 축어록 분석
└── data/                  # CSV 데이터 저장소
    ├── clients.csv        # 내담자 정보
    ├── sessions.csv       # 회기 기록
    ├── audio/             # 음성 파일 저장소
    └── transcripts/       # 축어록 텍스트 파일
```

### 주요 기능
1. **인증 시스템**: SECRET_PASSWORD 환경변수 기반 로그인
2. **내담자 관리**: 추가, 수정, 목록 조회, 이름/태그 검색, 상태 필터링
   - 클릭 가능한 내담자 이름으로 상세 페이지 이동
   - 태그 자동완성 및 시각적 태그 입력
3. **회기 관리**: 내담자별 회기 기록 추가 및 조회
   - 결제수단 선택 (현금/카드/바우처/무료)
   - 만원 단위 비용 표시
4. **음성 파일 관리**: 회기별 음성 파일 업로드 및 재생
   - MP3, WAV, M4A, OGG 등 다양한 형식 지원
   - 내장 오디오 플레이어로 바로 재생
5. **축어록 AI 분석**: OpenAI GPT-5를 이용한 전문 상담 분석
   - 파일 업로드 또는 텍스트 직접 입력
   - 8가지 항목 자동 분석 (요약, 스트레스, 개입 평가, 대안, 계획, 감정, 인지왜곡, 저항)
   - 분석 결과 CSV 저장
6. **데이터 내보내기**: 내담자/회기 목록 상단에서 CSV 다운로드
7. **자동 ID 생성**: 타임스탬프 기반 고유 ID 생성

### 환경 변수
- `SECRET_PASSWORD`: 로그인 비밀번호 (필수)
- `SESSION_SECRET`: Flask 세션 암호화 키 (자동 생성)
- `OPENAI_API_KEY`: OpenAI API 키 (AI 분석 기능 사용 시 필수)

## 사용자 선호사항
- 한글 UI 사용
- 깨끗하고 미니멀한 디자인 선호
- CSV 기반 간단한 데이터 관리 (MVP)

## 향후 개선 사항
- 내담자/회기 삭제 기능
- 회기 기록 필터링 (날짜 범위, 모드별)
- 통계 대시보드 (회기비 통계, 미납금 추적)
- 데이터 백업 및 복원 기능
- PostgreSQL 마이그레이션 고려
